{
  "fileName": "PrunedDigestNodeSync2Spec.scala",
  "filePath": "src/it/scala/org/ergoplatform/it/PrunedDigestNodeSync2Spec.scala",
  "url": "https://github.com/ergoplatform/ergo/src/it/scala/org/ergoplatform/it/PrunedDigestNodeSync2Spec.scala",
  "summary": "The `PrunedDigestNodeSync2Spec` class is a test suite for the `org.ergoplatform.it` package. It tests the synchronization of a pruned digest node with a mining node. The purpose of this test is to ensure that the digest node can synchronize with the mining node up to a certain height, without loading full blocks that should be pruned. \n\nThe test scenario is as follows:\n1. Start up a mining node and let it mine a chain of length approximately equal to `approxTargetHeight`.\n2. Shut down the mining node, restart it with mining turned off, and fetch its info to get the actual `targetHeight`.\n3. Start a digest node and wait until it gets synced with the mining node up to `targetHeight`, ensuring it does not load full blocks that should be pruned.\n4. Fetch the digest node info and compare it with the mining node's info.\n5. Make sure the digest node does not store full blocks with height less than `targetHeight - blocksToKeep`.\n\nThe `PrunedDigestNodeSync2Spec` class extends the `AnyFlatSpec` class and the `IntegrationSuite` trait. The `IntegrationSuite` trait provides a set of utility methods for starting and stopping Docker containers that run Ergo nodes. \n\nThe class defines several variables, including `approxTargetHeight`, `blocksToKeep`, `localVolume`, and `remoteVolume`. It also defines three `Config` objects: `minerConfig`, `nodeForSyncingConfig`, and `digestConfig`. These `Config` objects are used to configure the Ergo nodes that will be started by the test.\n\nThe `it should \"Pruned digest node synchronization\"` block is the actual test case. It starts a mining node, waits for it to reach the `approxTargetHeight`, stops it, starts a digest node, waits for it to reach the `approxTargetHeight`, fetches its info, and compares it with the mining node's info. The test case uses the `docker` object to start and stop the Ergo nodes.\n\nOverall, the `PrunedDigestNodeSync2Spec` class tests the synchronization of a pruned digest node with a mining node, ensuring that the digest node can synchronize up to a certain height without loading full blocks that should be pruned.",
  "questions": "1. What is the purpose of this code?\n- This code is for testing the synchronization of a pruned digest node with a mining node in the Ergo blockchain.\n\n2. What dependencies are being used in this code?\n- This code is using dependencies from Akka, ScalaTest, and ErgoPlatform.\n\n3. What is the testing scenario being executed in this code?\n- The testing scenario involves starting a mining node, shutting it down, starting a digest node, syncing it with the mining node up to a certain height, comparing the info of the two nodes, and ensuring that the digest node does not store full blocks below a certain height."
}